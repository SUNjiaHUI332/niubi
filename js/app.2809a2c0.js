(function(){var t={1815:function(){},3237:function(){},5168:function(){},6671:function(){},7492:function(){},7640:function(){},9119:function(t,e,n){"use strict";var o=n(6848),a=n(9143),i=n.n(a),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t.isLoggedIn?e("div",[e("div",{staticClass:"upload-container"},[e("div",{staticClass:"upload-wrapper"},[e("label",{staticClass:"upload-button"},[e("span",{staticClass:"upload-icon"},[t._v("ğŸ“„")]),e("span",{staticClass:"upload-text"},[t._v("é€‰æ‹©PDFæ–‡ä»¶")]),e("input",{attrs:{type:"file",accept:"application/pdf"},on:{change:t.handleFileUpload}})]),e("div",{staticClass:"action-buttons"},[e("button",{staticClass:"export-button",on:{click:t.exportToXLSX}},[e("span",{staticClass:"icon"},[t._v("ğŸ“¤")]),t._v(" å¯¼å‡ºXLSX ")]),e("button",{staticClass:"batch-edit-button",on:{click:function(e){t.showBatchEditModal=!0}}},[e("span",{staticClass:"icon"},[t._v("âœï¸")]),t._v(" æ‰¹é‡ç¼–è¾‘ ")])]),e("div",{staticClass:"conversion-system"},[e("h3",[t._v("PDFé¢˜åœ¨çº¿è½¬æ¢ç³»ç»Ÿï¼ˆ1.0.0ï¼‰")]),e("div",{staticClass:"system-info"},[e("p",[t._v(" æ–‡ä»¶ï¼š"),e("span",{staticClass:"status"},[t._v(t._s(t.fileName))])])]),t._m(0)])])]),t.parsedData.length?e("div",{staticClass:"table-container"},[e("el-table",{staticStyle:{width:"100%"},attrs:{height:"650",data:t.parsedData,"table-layout":"fixed"}},[e("el-table-column",{attrs:{type:"index",label:"åºå·",width:"80",align:"center"}}),e("el-table-column",{attrs:{prop:"course",label:"è¯¾ç¨‹",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function({row:n}){return[e("el-input",{model:{value:n.course,callback:function(e){t.$set(n,"course",e)},expression:"row.course"}})]}}],null,!1,2592193046)}),e("el-table-column",{attrs:{prop:"unit",label:"å•å…ƒ",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function({row:n}){return[e("el-input",{model:{value:n.unit,callback:function(e){t.$set(n,"unit",e)},expression:"row.unit"}})]}}],null,!1,1529771917)}),e("el-table-column",{attrs:{prop:"type",label:"é¢˜ç›®ç±»å‹",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"content",label:"é¢˜ç›®å†…å®¹",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"answer",label:"æ­£ç¡®ç­”æ¡ˆ",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"analysis",label:"è§£æ",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"image",label:"é…å›¾",align:"center",width:"300"}}),e("el-table-column",{attrs:{prop:"option1",label:"é€‰é¡¹1",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option2",label:"é€‰é¡¹2",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option3",label:"é€‰é¡¹3",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option4",label:"é€‰é¡¹4",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option5",label:"é€‰é¡¹5",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option6",label:"é€‰é¡¹6",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option7",label:"é€‰é¡¹7",align:"center",width:"100"}}),e("el-table-column",{attrs:{prop:"option8",label:"é€‰é¡¹8",align:"center",width:"100"}})],1)],1):t._e(),t.showBatchEditModal?e("div",{staticClass:"modal-overlay"},[e("div",{staticClass:"modal-content"},[e("h3",[t._v("æ‰¹é‡ç¼–è¾‘")]),e("div",{staticClass:"form-group"},[e("label",[t._v("è¯¾ç¨‹ï¼š")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.batchCourse,expression:"batchCourse"}],staticClass:"form-input",domProps:{value:t.batchCourse},on:{input:function(e){e.target.composing||(t.batchCourse=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",[t._v("å•å…ƒï¼š")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.batchUnit,expression:"batchUnit"}],staticClass:"form-input",domProps:{value:t.batchUnit},on:{input:function(e){e.target.composing||(t.batchUnit=e.target.value)}}})]),e("div",{staticClass:"modal-actions"},[e("button",{staticClass:"confirm-button",on:{click:t.applyBatchEdit}},[t._v("ç¡®è®¤")]),e("button",{staticClass:"cancel-button",on:{click:function(e){t.showBatchEditModal=!1}}},[t._v(" å–æ¶ˆ ")])])])]):t._e(),t.isUploading?e("div",{staticClass:"uploading-overlay"},[e("div",{staticClass:"uploading-spinner"}),e("div",{staticClass:"uploading-text"},[t._v("æ­£åœ¨ä¸Šä¼ å¹¶è§£æPDFæ–‡ä»¶ï¼Œè¯·ç¨å€™...")])]):t._e()]):e("div",{staticClass:"login-container"},[e("div",{staticClass:"login-box"},[e("h2",[t._v("PDFé¢˜åœ¨çº¿è½¬æ¢ç³»ç»Ÿï¼ˆ1.0.0ï¼‰")]),e("div",{staticClass:"form-group"},[e("label",[t._v("ç”¨æˆ·åï¼š")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-input",attrs:{type:"text"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",[t._v("å¯†ç ï¼š")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-input",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("button",{staticClass:"login-button",on:{click:t.handleLogin}},[t._v("ç™»å½•")])])])])},l=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"system-info"},[e("p",[t._v("å½“å‰çŠ¶æ€ï¼š"),e("span",{staticClass:"status"},[t._v("è¿è¡Œä¸­")])])])}],r=(n(4114),n(8111),n(2489),n(116),n(7588),n(1701),n(5279)),c=n(6726),p=n.n(c),u=n(3230),d={name:"App",data(){return{parsedData:[],showBatchEditModal:!1,batchCourse:"",batchUnit:"",isUploading:!1,isLoggedIn:!0,username:"PDFé¢˜åœ¨çº¿è½¬æ¢ç³»ç»Ÿï¼ˆ1.0.0ï¼‰",password:"123456",fileName:""}},mounted(){},methods:{async handleFileUpload(t){this.isUploading=!0;const e=t.target.files[0];this.fileName=e?e.name:"æœªé€‰æ‹©æ–‡ä»¶";const n=this.fileName.match(/ã€Š(.+?)ã€‹/)?.[1]||"é»˜è®¤å•å…ƒ";setTimeout((async()=>{this.isUploading=!1;const e=t.target.files[0];if(e){const t=await e.arrayBuffer();r.GlobalWorkerOptions.workerSrc=p();try{const e=r.getDocument({data:t,disableAutoFetch:!0,disableStream:!0}),o=await e.promise,a=o.numPages;let i="";for(let t=1;t<=a;t++){const e=await o.getPage(t),n=await e.getTextContent();i+=n.items.map((t=>t.str)).join("\n")+"\n"}const s=i.replace(/ç¾¿è¿‡æ•™è‚²å®˜ç½‘ www\.yiguojy\.com ç‰ˆæƒæ‰€æœ‰/g,"").replace(/ä¸“ä¸šç½‘æ ¡è¯¾ç¨‹ã€é¢˜åº“è½¯ä»¶ã€è€ƒè¯•ç”¨ä¹¦ã€èµ„è®¯ä¿¡æ¯å…¨æ–¹ä½ä¸€ä½“åŒ–èŒä¸šè€ƒè¯•å­¦ä¹ å¹³å°/g,""),l=s.split(/(?=\d+\.)/g),c=[];l.forEach((t=>{const e=t.split("\n").filter((t=>t.trim()));if(e.length>=3){const t=e.slice(1,-2).filter((t=>!t.startsWith("å‚è€ƒç­”æ¡ˆ")&&!t.startsWith("ã€"))).map((t=>t.trim())),a=e.findIndex((t=>t.startsWith("ã€ç¾¿è¿‡è§£æã€‘")));var o=e.slice(a).join("\n").split("ã€ç¾¿è¿‡è§£æã€‘")[1];/\d$/.test(o)&&(o=o.slice(0,-1)),o&&o.endsWith("é—®ç­”é¢˜")&&(o=o.slice(0,-3));const i={A:"option1",B:"option2",C:"option3",D:"option4",E:"option5",F:"option6",G:"option7",H:"option8"},s={};t.forEach((t=>{const e=t.match(/^([A-H])\.\s*(.*)/);if(e){const[,t,n]=e;s[i[t]]=n}}));const l=e.find((t=>t.startsWith("å‚è€ƒç­”æ¡ˆï¼š"))),r=-1!==e.findIndex((t=>t.startsWith("ã€ç¾¿è¿‡è§£æã€‘")))?e.findIndex((t=>t.startsWith("ã€ç¾¿è¿‡è§£æã€‘"))):e.length,p=e[e.indexOf(l)].replace("å‚è€ƒç­”æ¡ˆï¼š","").trim().match(/^[A-H]$/)?.[0]||e.slice(e.indexOf(l),r).join("\n").replace(/\d+/g,"").replace("å‚è€ƒç­”æ¡ˆï¼š","").trim();let u="";for(let n=0;n<e.length;n++){const t=e[n];if(t.startsWith("A.")){u=e.slice(0,n).join("").replace(/^\d+\./,"");break}if(t.endsWith("ã€‚")||t.endsWith("ï¼‰")||t.includes("å‚è€ƒç­”æ¡ˆï¼š")||t.endsWith("ï¼Ÿ")||/^\(\d+\)/.test(t)){if(t.includes("å‚è€ƒç­”æ¡ˆï¼š")||(u+=t.replace(/^\d+\./,"")),t.endsWith("ã€‚")||t.endsWith("ï¼‰")||t.includes("å‚è€ƒç­”æ¡ˆï¼š")||t.endsWith("ï¼Ÿ"))break}else u+=t.replace(/^\d+\./,"")}console.log(p,"æ­£ç¡®ç­”æ¡ˆ"),c.push({course:"ä¸“å‡æœ¬-æ³•å­¦ç±»",unit:n,type:"å•é€‰é¢˜",content:u,answer:"A"==p?1:"B"==p?2:"C"==p?3:"D"==p?4:"E"==p?5:"F"==p?6:"G"==p?7:"H"==p?8:p,analysis:"ã€å¾·é‘«è§£æã€‘"+(o||"æ­¤é¢˜æš‚æ— è§£æ"),image:"",option1:s.option1?1:"",option2:s.option2?2:"",option3:s.option3?3:"",option4:s.option4?4:"",option5:s.option5?5:"",option6:s.option6?6:"",option7:s.option7?7:"",option8:s.option8?8:""})}})),this.parsedData=c}catch(o){console.error("PDFè§£æå¤±è´¥:",o)}}}),1500)},exportToXLSX(){if(0===this.parsedData.length)return void alert("æ²¡æœ‰æ•°æ®å¯ä»¥å¯¼å‡ºï¼");const t={course:"è¯¾ç¨‹",unit:"å•å…ƒ",type:"é¢˜ç›®ç±»å‹",content:"é¢˜ç›®å†…å®¹",answer:"æ­£ç¡®ç­”æ¡ˆ",analysis:"è§£æ",image:"é…å›¾",option1:"é€‰é¡¹1",option2:"é€‰é¡¹2",option3:"é€‰é¡¹3",option4:"é€‰é¡¹4",option5:"é€‰é¡¹5",option6:"é€‰é¡¹6",option7:"é€‰é¡¹7",option8:"é€‰é¡¹8"},e=this.parsedData.map((e=>{const n={};for(const o in e)n[t[o]]=e[o];return n})),n=u.Wp.json_to_sheet(e),o=u.Wp.book_new();u.Wp.book_append_sheet(o,n,"Sheet1");const a=this.fileName?this.fileName.replace(".pdf",".xlsx"):"export.xlsx";u._h(o,a)},applyBatchEdit(){this.parsedData.forEach((t=>{this.batchCourse&&(t.course=this.batchCourse),this.batchUnit&&(t.unit=this.batchUnit)})),this.showBatchEditModal=!1}}},f=d,h=n(1656),m=(0,h.A)(f,s,l,!1,null,null,null),b=m.exports;o["default"].use(i()),new o["default"]({el:"#app",render:t=>t(b)})}},e={};function n(o){var a=e[o];if(void 0!==a)return a.exports;var i=e[o]={id:o,loaded:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,o,a,i){if(!o){var s=1/0;for(p=0;p<t.length;p++){o=t[p][0],a=t[p][1],i=t[p][2];for(var l=!0,r=0;r<o.length;r++)(!1&i||s>=i)&&Object.keys(n.O).every((function(t){return n.O[t](o[r])}))?o.splice(r--,1):(l=!1,i<s&&(s=i));if(l){t.splice(p--,1);var c=a();void 0!==c&&(e=c)}}return e}i=i||0;for(var p=t.length;p>0&&t[p-1][2]>i;p--)t[p]=t[p-1];t[p]=[o,a,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var a,i,s=o[0],l=o[1],r=o[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(r)var p=r(n)}for(e&&e(o);c<s.length;c++)i=s[c],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(p)},o=self["webpackChunkniuzi"]=self["webpackChunkniuzi"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(9119)}));o=n.O(o)})();
//# sourceMappingURL=app.2809a2c0.js.map